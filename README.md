# Health Survey Cluster Analysis

## Project Overview
This project analyzes the 2022 NHIS (National Health Interview Survey) data to identify patterns and clusters among health indicators with R. Using exploratory data analysis, dimensionality reduction techniques, and clustering algorithms, this analysis aims to uncover meaningful segments within health survey respondents.

### Completed Work
* **[data preprocessing](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/data_preprocessing.ipynb)**: Code used to preprocess the inital 2022 NHIS survey data, exported as [adult22_filtered.csv](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/data/adult22_filtered.csv)
* **[data understanding](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/data_understanding.ipynb)**: Analysis of dataset dimensions, variable types (categorical vs numerical, ordinal vs nominal), and data completeness. 
* **[univariate analysis](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/univariate_analysis.ipynb)**: Analysis of individual variables with:
  * Numerical variables: Summary statistics, density plots, and boxplots.
  * Categorical variables: Bar plots and proportion tables.
* **[numerical bivariate analysis](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/bivariate_analysis_notebooks/numerical_bivariate_analysis.ipynb)**: Correlation heatmap and scatterplots for numerical variables.
* **[categorical mixed bivariate analysis](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/bivariate_analysis_notebooks/categorical_mixed_bivariate_analysis.ipynb)**: Contingency tables, chi-square tests, stacked bar charts, group-wise statistics, t-tests, and ANOVA results.
* **[Conditional Plots Multivariate Analysis](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/multivariate_analysis_notebooks/conditional_plots_multivariate_analysis.ipynb)**: Creating conditional plots (scatterplot grouped by categorical variable, but different plots for each category). Each graph can be found here : **[Conditional Plots](https://github.com/Cstan1987stat/health-survey-cluster-analysis/tree/main/graphs/conditional_plots)**. 
* **[Pair Plots Multivariate Analysis](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/multivariate_analysis_notebooks/pair_plots_multivariate_analysis.ipynb)**: Creating pair plots for each categorical variable (including scatterplot grouped by category, density plots grouped by category, and correlation values for each category). All plots can be found here: **[Pairplots](https://github.com/Cstan1987stat/health-survey-cluster-analysis/tree/main/graphs/pair_plots)**.
* **[Outlier Check and Feature Engineering](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/outlier_check_feature_engineering.ipynb)**: Checking for outliers, scaling numeric variables, one-hot encoding categorical variables, and exporting data as [adult22_transformed_e.csv](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/data/adult22_transformed_e.csv). Also scaled only the numeric variables, leaving categorical variables as is, and exported as [adult22_transformed_n.csv](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/data/adult22_transformed_n.csv).
* **[FAMD](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/famd_notebook.ipynb)**: Applying factor analysis for mixed data to **adult22_transformed_n.csv** and exported all created dimensions as **[famd_coord.csv](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/data/famd_coord.csv)**.
* **[Initial Kmeans Clustering](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/initial_kmeans_clustering.ipynb)**: Applying kmeans clustering to the first 20 columns of **[famd_coord.csv](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/data/famd_coord.csv)**, decided on 5 clusters, and exported initial data with the clusters as **[data_w_5_clusters.csv](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/data/data_w_5_clusters.csv)**.
*  **[Numerical Cluster Analysis](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/cluster_analysis.ipynb)**: Analyzing the clusters by examining the numerical features of the data. Mean and standard deviation were calculated for each cluster, and boxplots were created to visually explore the distribution of features across clusters. Additionally, decision trees were fitted and interpreted to uncover the key patterns and relationships driving the cluster assignments.
*  **[Categorical cluster Analysis](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/categorical_cluster_analysis.ipynb)**: Analyzing the clusters by examing the categorical features of the data. Includes contingency tables, proportion plots, and basic decision trees to explore patterns and relationships within the cluster assignments.
*  **[UMAP KMeans Hclust](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/umap_kmeans_hclust.ipynb)**: Removed the Education, Region, and cluster features from **data_w_5_clusters**. Transformed numeric and categorical variables accordingly using a standard scale and scale_one_hot_encode functions from *[Helper Functions](https://github.com/Cstan1987stat/Help-Functions)*. Used UMAP to reduce the data to 6 dimensions. Performed k-means and hierarchical clustering (complete, single, and average linkage) on the reduced data. Evaluated cluster performance using mean silhouette scores, selecting 4 clusters from average linkage as optimal. Merged clustering results from the non-transformed health features and exported the final dataset as **[adult_22_hclust.csv](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/data/adult_22_hclust.csv)**.
*  **[Final Cluster Interpretation](https://github.com/Cstan1987stat/health-survey-cluster-analysis/blob/main/notebooks/final_cluster_interpretation.ipynb)**: Analyzing the clusters by calculating the mean, standard deviation, and skewness for each numeric feature grouped by the clusters. Additionally, grouped boxplots and grouped density plots were also analyzed. Proportion plots were analyzed for the categorical features and clusters, along with fitting a basic decision tree to find the features that best split up the clusters. Finally, a basic Random Forest classifier was fitted using all features to determine the best features overall for splitting up the clusters properly. Top five variables that appeared the most often in importance were whether the individual had smoked 100 cigarettes, male or female, their height in inches, whether they have a history of depression, and the frequency of days drank in the past 12 months. Ultimately, each cluster was assigned a descriptive label:
    * Cluster 1 - Older Male, Experienced Smokers, and Most Frequent Drinkers.
    * Cluster 2 - Least Frequent Drinking Females.
    * Cluster 3 - Experienced Female Smokers, Highest Average Sleep.
    * Cluster 4 - Youngest, Tallest Males.

## Conclusion
Unlike my other previous two projects that I've really worked on since graduating, a **[Johnson County House Selling Price Prediction](https://github.com/Cstan1987stat/Cstan1987stat-JC-SFR-Selling-Price-Prediction)** project and a **[Diabetes Prediction](https://github.com/Cstan1987stat/-Health-Data-Insights-Predicting-Diabetes-with-Machine-Learning)** project, this is the project that I feel is the best work I've done. Not only have I been working in R, a language and tool I've not worked with in at least a year since I started this project, but also having it be my first ml project with unsupervised learning. Furthermore, I went into both previous projects with a specific score I wanted to get for both. I never got anywhere close to either, and it greatly frustrated me. However, with unsupervised machine learning, it is a different beast. I spent a large portion of my time with a thorough exploratory analysis of my variables. Once this was done, it then took a while for me to understand how to interpret the clusters that I had gotten. Once I finally interpreted the clusters, I was disappointed as there a class imbalance and felt that the initial clusters were gotten had a big emphasis on my education variable, which I really didn't want to be the focus of this 'health' focused notebook. After removing the Region and Education features, along with a new feature reduction technique, I was able to find 4 clusters using hierarchical clustering using average linkage that were fairly balanced. 
